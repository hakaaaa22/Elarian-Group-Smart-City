import React, { useState } from 'react';
import { motion } from 'framer-motion';
import {
  Shield, AlertTriangle, Globe, Activity, Lock,
  Wifi, Server, Database, Eye, Zap
} from 'lucide-react';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import { Progress } from '@/components/ui/progress';

const threats = [
  { id: 1, type: 'DDoS Attack', severity: 'critical', source: '185.234.xx.xx', target: 'Web Server A', status: 'active', lat: 51.5, lng: -0.12 },
  { id: 2, type: 'Malware Detected', severity: 'high', source: '91.121.xx.xx', target: 'Workstation 23', status: 'mitigated', lat: 48.8, lng: 2.35 },
  { id: 3, type: 'Brute Force', severity: 'medium', source: '203.45.xx.xx', target: 'SSH Gateway', status: 'investigating', lat: 35.6, lng: 139.7 },
  { id: 4, type: 'Phishing Attempt', severity: 'low', source: '45.33.xx.xx', target: 'Email System', status: 'mitigated', lat: 37.7, lng: -122.4 },
  { id: 5, type: 'Unauthorized Access', severity: 'high', source: '178.62.xx.xx', target: 'Database Server', status: 'active', lat: 52.5, lng: 13.4 },
];

const severityColors = {
  critical: { bg: 'bg-red-500/20', text: 'text-red-400', border: 'border-red-500/30' },
  high: { bg: 'bg-orange-500/20', text: 'text-orange-400', border: 'border-orange-500/30' },
  medium: { bg: 'bg-yellow-500/20', text: 'text-yellow-400', border: 'border-yellow-500/30' },
  low: { bg: 'bg-green-500/20', text: 'text-green-400', border: 'border-green-500/30' },
};

const statusColors = {
  active: 'bg-red-500',
  investigating: 'bg-amber-500',
  mitigated: 'bg-emerald-500',
};

export default function CybersecurityMap() {
  const [selectedThreat, setSelectedThreat] = useState(null);

  const criticalCount = threats.filter(t => t.severity === 'critical').length;
  const activeCount = threats.filter(t => t.status === 'active').length;

  return (
    <div className="min-h-screen p-4 lg:p-6 space-y-6">
      {/* Header */}
      <motion.div
        initial={{ opacity: 0, y: -20 }}
        animate={{ opacity: 1, y: 0 }}
      >
        <h1 className="text-2xl lg:text-3xl font-bold text-white flex items-center gap-3">
          <Shield className="w-8 h-8 text-purple-400" />
          Cybersecurity Threat Map
        </h1>
        <p className="text-slate-400 mt-1">Global threat intelligence & monitoring</p>
      </motion.div>

      {/* Stats */}
      <div className="grid grid-cols-2 lg:grid-cols-4 gap-4">
        {[
          { label: 'Total Threats', value: threats.length, icon: AlertTriangle, color: 'amber' },
          { label: 'Critical', value: criticalCount, icon: Zap, color: 'red' },
          { label: 'Active Attacks', value: activeCount, icon: Activity, color: 'purple' },
          { label: 'Systems Protected', value: '156', icon: Lock, color: 'emerald' },
        ].map((stat, i) => (
          <motion.div
            key={stat.label}
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: i * 0.1 }}
          >
            <Card className="glass-card border-indigo-500/20 bg-[#0f1629]/80">
              <CardContent className="p-4">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-2xl font-bold text-white">{stat.value}</p>
                    <p className="text-xs text-slate-400">{stat.label}</p>
                  </div>
                  <div className={`p-3 rounded-xl bg-${stat.color}-500/20`}>
                    <stat.icon className={`w-5 h-5 text-${stat.color}-400`} />
                  </div>
                </div>
              </CardContent>
            </Card>
          </motion.div>
        ))}
      </div>

      <div className="grid lg:grid-cols-3 gap-6">
        {/* Threat Map Visualization */}
        <motion.div
          initial={{ opacity: 0, scale: 0.95 }}
          animate={{ opacity: 1, scale: 1 }}
          className="lg:col-span-2"
        >
          <Card className="glass-card border-indigo-500/20 bg-[#0f1629]/80">
            <CardHeader>
              <CardTitle className="text-white flex items-center gap-2">
                <Globe className="w-5 h-5 text-cyan-400" />
                Global Threat Map
              </CardTitle>
            </CardHeader>
            <CardContent>
              <div className="aspect-[16/9] bg-slate-900 rounded-xl relative overflow-hidden">
                {/* World Map Background */}
                <div className="absolute inset-0 opacity-30" style={{
                  backgroundImage: `url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 500'%3E%3Cpath fill='%236366f1' fill-opacity='0.3' d='M473,95c-14,2-24,7-31,13-11,9-20,18-38,13-11-3-22-7-34-4s-22,14-26,25c-3,11,2,22,10,30s19,14,26,24c8,11,5,30-6,38-11,7-26,4-38-1-12-6-24-13-37-14-13,0-26,6-36,14s-17,19-17,31c1,12,10,21,21,27,11,7,23,12,33,19,10,8,18,19,19,31,1,14-7,28-18,37-11,8-26,12-38,20-12,9-22,22-24,36-1,10,2,20,8,28,6,9,15,15,24,21,9,5,18,11,25,19,8,9,12,22,8,33-4,12-16,20-28,24-12,5-26,7-37,13-12,6-22,17-23,30-1,12,6,24,15,33,10,9,22,16,32,25,10,10,18,23,17,37-1,15-12,27-24,36-12,8-27,14-38,24-10,10-17,26-12,40,4,13,16,23,29,29,13,6,27,9,39,16,12,8,22,20,22,34,0,14-10,26-22,34-11,8-25,13-37,20-11,8-21,19-21,32,0,14,12,25,24,33,13,8,27,14,38,24,12,10,20,25,17,40-3,14-15,25-28,33-13,7-28,11-40,19-12,9-21,23-18,37,3,13,14,23,26,30,12,6,26,10,37,18,11,9,18,23,15,36-3,13-14,23-27,29-13,5-28,8-40,15-13,7-24,20-22,34,2,13,13,23,25,30,13,7,27,11,39,19,11,8,19,21,17,34-2,14-14,24-26,31-13,7-27,12-39,20-12,9-20,24-15,38,4,12,16,21,28,27,13,6,27,9,39,16,12,7,22,19,22,33,0,14-11,25-23,33-12,8-27,13-38,22-11,10-18,25-13,39,4,13,17,22,30,28,13,5,28,7,40,14,13,7,24,20,24,35,0,15-12,28-25,36-14,9-30,13-43,22-13,10-22,27-15,42,6,14,22,21,37,25,15,3,31,2,46,4,15,3,30,10,38,23,8,12,7,28-2,40-9,12-24,17-38,22-15,5-31,9-44,18-13,9-21,25-16,40,5,14,20,22,35,27,15,4,31,4,45,9,14,6,27,16,32,30,5,14,1,30-10,41-11,10-26,14-40,18-15,4-30,8-43,16-13,9-22,25-16,40,5,14,20,23,36,27,15,4,31,3,46,7,15,4,30,13,37,27,7,15,3,33-9,45-11,11-28,14-43,18-15,4-31,8-44,17-13,9-22,26-14,42,8,16,27,23,46,26,19,2,38-2,57,0,19,3,38,12,49,28,11,17,12,41-3,55-14,14-36,18-56,21-19,4-39,7-57,15-18,8-34,23-38,43-4,19,6,40,21,53,16,14,37,18,57,21,20,3,41,3,60,9,19,6,37,20,43,40,6,20-3,44-19,59-16,14-39,18-60,22-21,4-43,8-62,17-19,10-35,28-35,50,0,22,16,41,35,52,19,11,42,12,63,14,21,2,43,4,62,13,19,9,36,28,36,51,0,22-17,41-37,51-19,10-43,10-64,15-21,6-42,16-55,35-13,18-16,45-3,66,14,20,39,27,63,31,24,3,49,0,72,6,23,6,45,21,52,44,7,23-2,50-22,66-20,16-48,18-73,21-25,3-51,6-73,18-22,12-41,35-38,62,3,27,27,46,53,55,26,9,54,6,80,9,26,4,52,15,67,37,16,22,18,55,1,80-17,24-48,33-78,39-30,6-61,9-88,22-27,13-51,40-47,72,4,31,35,51,67,62,32,10,66,5,98,11,32,6,64,25,79,54,15,29,11,68-16,92-27,24-67,27-102,32-35,5-71,11-101,29-30,18-53,52-43,89,10,36,48,56,88,68,40,11,81,5,121,14,40,9,79,35,94,73,15,37,3,84-33,110-36,25-85,25-127,30-42,5-85,14-119,39-34,25-59,67-44,111,16,42,63,63,113,76,49,12,100,3,148,17,48,14,95,51,107,100,12,47-13,103-61,132-48,28-109,25-161,32-52,7-106,23-145,60-40,37-63,98-37,151,26,51,88,73,151,88,62,14,126-1,185,23,59,24,114,78,117,143,3,63-49,122-117,155-67,33-148,29-216,45-67,16-137,54-174,114-37,60-38,145,22,197,59,50,143,61,220,77,77,16,156,20,227,58,70,38,134,114,119,197-15,81-98,139-189,178-91,38-194,44-285,78-90,34-177,101-200,195-22,92,30,194,118,260,88,65,198,79,302,104,104,25,211,47,303,111,91,63,172,168,146,280-26,110-142,184-268,237-125,52-264,55-391,96-126,41-250,122-286,251-36,127,35,271,150,368,114,95,259,118,395,159,135,40,274,82,393,168,118,85,225,217,187,361-38,142-192,230-353,296-160,65-337,71-499,128-161,57-320,171-359,340-38,166,71,347,228,468,156,119,350,149,536,202,185,52,376,107,542,217,165,109,314,285,261,479-52,190-266,310-488,405-220,94-462,106-684,186-221,80-441,240-485,474-44,229,119,474,339,649,219,173,492,226,755,311,261,84,531,175,764,339,232,163,446,413,371,689-75,273-400,435-736,555-334,119-697,131-1033,244-334,113-667,353-708,706-40,347,242,682,603,916,361,232,793,321,1207,462,413,140,843,297,1218,571,373,272,716,690,561,1138-155,446-676,721-1222,935-543,213-1135,211-1683,400-546,189-1087,604-1158,1188-69,573,448,1101,1099,1481,648,377,1431,482,2165,700,731,217,1506,483,2166,952,656,467,1248,1196,915,1962-333,765-1308,1176-2337,1505-1024,327-2151,321-3187,611-1033,290-2049,934-2140,1848-89,898,797,1714,1850,2349,1046,631,2319,801,3516,1115,1194,313,2445,712,3499,1399,1049,683,1973,1766,1332,2874-640,1102-2187,1662-3819,2104-1627,440-3413,424-5062,836-1645,411-3256,1355-3317,2716-60,1335,1389,2473,3052,3408,1656,929,3663,1158,5561,1588,1893,429,3877,1021,5538,2006,1653,981,3100,2558,1890,4171-1206,1608-3943,2327-6803,2946-2850,617-5993,548-8939,1108-2938,559-5837,1925-5705,3818,132,1887,2554,3374,5252,4629,2686,1249,5919,1527,8969,2142,3039,613,6214,1397,8895,2730,2670,1326,4980,3487,2807,5649-2163,2154-6467,2943-10905,3636-4423,691-9296,624-13877,1356-4568,731-9106,2563-8617,5064,488,2491,4279,4348,8453,5947,4157,1592,9118,1949,13823,2739,4687,787,9580,1819,13699,3548,4101,1720,7623,4503,4153,7247-3458,2733-10117,3618-17006,4434-6865,812-14419,716-21514,1656-7074,937-14109,3295-13148,6467,959,3166,6705,5385,12949,7315,6221,1922,13642,2423,20685,3429,7019,1003,14347,2286,20633,4489,6256,2192,11586,5741,5858,9226-5708,3475-16104,4521-26807,5506-10668,982-22404,880-33505,2069-11063,1186-22084,4155-20231,8023,1849,3858,10303,6545,19401,8916,9062,2360,19873,3001,30192,4254,10285,1249,21032,2908,30389,5711,9302,2787,17140,7337,6804,11747-10303,4393-28981,5641-47995,6856-18961,1212-39798,1101-59712,2620-19838,1514-39617,5269-36008,10102,3606,4827,16160,8148,29670,11092,13463,2933,29456,3798,44843,5396,15337,1594,31318,3748,45425,7335,14029,3567,25917,9347,9831,14929-16038,5561-44859,7091-74126,8618-29190,1523-61309,1390-91821,3345-30413,1949-60742,6680-54758,12743,5977,6053,25044,10215,46058,13922,20960,3696,45898,4836,69908,6899,23927,2058,48860,4914,71265,9617,22299,4681,41238,12293,11844,19576-29309,7264-81650,9189-134609,11187-52854,1995-111121,1834-166301,4427-54965,2588-109831,8573-98334,16280,11482,7695,47922,12842,87566,17460,39553,4609,86523,6178,130998,8851,44360,2667,90615,6419,132358,12537,41503,6088,76491,15971,14716,25319-61657,9323-171085,11728-281323,14305-110017,2573-231169,2396-346227,5789-114710,3385-229276,11194-204795,21298,24444,10094,98775,16765,180199,22779,81280,6003,177682,8158,268440,11617,90510,3453,185183,8481,271380,16497,85686,7978,158042,20910,22775,33053-135046,12105-374667,15224-615296,18620-240269,3390-504283,3205-755426,7736-250481,4520-500709,14953-443686,28449,56925,13483,226298,22206,413260,30082,186758,7860,407629,10940,616411,15605,208376,4652,426152,11416,619786,22127,192578,10656,355706,27978,36704,44148-318626,16118-884158,20252-1450913,24871-566181,4611-1187795,4385-1779095,10610-589835,6211-1179268,20490-1041992,38922,137021,18418,545888,29959,990621,40408,444318,10429,969254,14716,1469165,20887,498683,6146,1021004,15350,1498605,29752,474862,14302,875797,37488,68024,59180-806881,21677-2239779,27239-3675138,33445-1435105,6197-3011061,5916-4523298,14325-1508268,8393-3015835,27597-2659666,52459,355526,24807,1414884,39973,2559929,53682,1059004,13682,2309254,19553,3497050,27845,1184093,8267,2425456,20587,3552645,39798,1121158,19148,2068100,50131,152584,79183-1914515,29029-5316040,36488-8722436,44783-3403236,8284-7139972,7946-10722854,19204-3574361,11244-7146509,36977-6305169,70156,839661,33181,3339965,52955,6049831,71005,2499862,18022,5452298,25885,8249750,36925,2788855,11022,5718556,27356,8374305,52752,2641055,25406,4870608,66464,251574,104884-4519091,38510-12545610,48448-20581694,59446-8038020,10990-16862330,10599-25342295,25518-8446133,14896-16884780,49063-14885009,93071,1998154,44011,7946946,70010,14395866,94042,5947888,24012,12966898,34547,19610970,49213,6618880,14681,13578652,36480,19882500,70264,6270043,33860,11558178,88562,333968,139759-10705379,51185-29725180,64449-48766426,79279-19037929,14650-39940508,14151-60061085,34043-20040813,19860-40073234,65375-35260251,124054,4808858,58654,19127685,93262,34649178,125333,14316818,32517,31213832,46758,47202090,66555,15926098,19826,32669382,49311,47833616,94901,15071700,45766,27787328,119677,449903,188778-25736619,68230-71440019,85933-117236302,105881-45702949,19538-95862988,18893-144143232,45545-48177161,26508-96337456,87299-84780765,165604,11549867,78205,45946648,124469,83212809,167236,34391827,43382,74996746,62386,113445706,88901,38269012,26484,78488606,65830,115004266,126702,36205877,60993,66770693,159552,605451,251753-61865313,91010-171726765,114633-281804330,141399-109860629,26093-230528117,25260-346444088,60847-115801632,35376-231583014,116475-203695903,221003,27765011,104325,110433629,166232,199979361,223243,82660299,57879,180233972,83393,272563621,118864,91912756,35405,188560700,87824,276217432,169066,86928795,81346,160282813,212725,807730,335693-148626133,121340-412574831,152893-677081568,188660-263882741,34790-553780389,33722-833287972,81039-279363628,47155-558709543,155212-491598591,294696,67023168,139256,266567636,221819,483049588,297884,199501649,76130,434982610,109678,658010016,156486,221645403,46676,454606914,115652,665880844,222772,209567779,106920,386399825,280101,1061955,441773]'/%3E%3C/svg%3E")`,
                  backgroundSize: 'cover',
                  backgroundPosition: 'center'
                }} />

                {/* Threat Points */}
                {threats.map((threat, i) => (
                  <motion.div
                    key={threat.id}
                    initial={{ scale: 0 }}
                    animate={{ scale: 1 }}
                    transition={{ delay: 0.3 + i * 0.1 }}
                    className="absolute cursor-pointer"
                    style={{
                      left: `${((threat.lng + 180) / 360) * 100}%`,
                      top: `${((90 - threat.lat) / 180) * 100}%`
                    }}
                    onClick={() => setSelectedThreat(threat)}
                  >
                    <div className={`relative ${threat.status === 'active' ? 'animate-pulse' : ''}`}>
                      <div className={`w-4 h-4 rounded-full ${statusColors[threat.status]}`} />
                      {threat.status === 'active' && (
                        <div className={`absolute inset-0 w-4 h-4 rounded-full ${statusColors[threat.status]} animate-ping`} />
                      )}
                    </div>
                  </motion.div>
                ))}

                {/* Attack Lines Animation */}
                <svg className="absolute inset-0 w-full h-full pointer-events-none">
                  {threats.filter(t => t.status === 'active').map((threat, i) => (
                    <motion.line
                      key={i}
                      initial={{ pathLength: 0, opacity: 0 }}
                      animate={{ pathLength: 1, opacity: [0, 1, 0] }}
                      transition={{ duration: 2, repeat: Infinity, delay: i * 0.5 }}
                      x1={`${((threat.lng + 180) / 360) * 100}%`}
                      y1={`${((90 - threat.lat) / 180) * 100}%`}
                      x2="50%"
                      y2="50%"
                      stroke="#ef4444"
                      strokeWidth="1"
                      strokeDasharray="5 5"
                    />
                  ))}
                </svg>

                {/* Center Point (Target) */}
                <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2">
                  <div className="w-6 h-6 rounded-full bg-cyan-500/50 flex items-center justify-center">
                    <Shield className="w-4 h-4 text-cyan-400" />
                  </div>
                </div>
              </div>
            </CardContent>
          </Card>
        </motion.div>

        {/* Threat List */}
        <motion.div
          initial={{ opacity: 0, x: 20 }}
          animate={{ opacity: 1, x: 0 }}
        >
          <Card className="glass-card border-indigo-500/20 bg-[#0f1629]/80 h-full">
            <CardHeader>
              <CardTitle className="text-white flex items-center gap-2">
                <AlertTriangle className="w-5 h-5 text-amber-400" />
                Active Threats
              </CardTitle>
            </CardHeader>
            <CardContent className="space-y-3">
              {threats.map((threat) => {
                const colors = severityColors[threat.severity];
                return (
                  <div
                    key={threat.id}
                    onClick={() => setSelectedThreat(threat)}
                    className={`p-4 rounded-xl cursor-pointer transition-all ${
                      selectedThreat?.id === threat.id 
                        ? 'bg-indigo-500/20 border border-indigo-500/50' 
                        : 'bg-slate-800/50 hover:bg-slate-800 border border-transparent'
                    }`}
                  >
                    <div className="flex items-center justify-between mb-2">
                      <span className="text-white font-medium text-sm">{threat.type}</span>
                      <Badge className={`${colors.bg} ${colors.text} ${colors.border} border text-xs`}>
                        {threat.severity}
                      </Badge>
                    </div>
                    <p className="text-slate-400 text-xs">Source: {threat.source}</p>
                    <p className="text-slate-400 text-xs">Target: {threat.target}</p>
                    <div className="flex items-center gap-2 mt-2">
                      <div className={`w-2 h-2 rounded-full ${statusColors[threat.status]}`} />
                      <span className="text-xs text-slate-300 capitalize">{threat.status}</span>
                    </div>
                  </div>
                );
              })}
            </CardContent>
          </Card>
        </motion.div>
      </div>
    </div>
  );
}